function trackDigests(t){t.run(["$rootScope",function(t){Promise.setScheduler(function(e){t.$evalAsync(e)})}])}var app=angular.module("app",["ngSanitize","ui.bootstrap","toastr","ui.router","ngDialog","LocalStorageModule","ionic"]);app.config(["$stateProvider","$urlRouterProvider","$interpolateProvider",function(t,e,n){n.startSymbol("{[{"),n.endSymbol("}]}"),e.otherwise("/index"),t.state("index",{url:"/index",views:{main:{templateUrl:"_index.html"}}}).state("register",{url:"/register",views:{main:{templateUrl:"_create_account.html"}}}).state("login",{url:"/login",views:{main:{templateUrl:"_sign_in.html"}}}).state("home",{url:"/home",views:{main:{templateUrl:"_welcome.html"}}}).state("priceEstimator",{url:"/estimator",views:{main:{controller:"priceEstimateController",templateUrl:"_price_estimates.html"}}}).state("requestUber",{url:"/requestUber",views:{main:{controller:"requestUberController",templateUrl:"_request_uber.html"}}}).state("rideStatus",{url:"/rideStatus",views:{main:{controller:"uberRideStatusController",templateUrl:"_ride_status.html"}}}).state("connectToUber",{url:"/connect",views:{main:{templateUrl:"_connect_to_uber.html"}}})}]),app.config(["$httpProvider",function(t){t.interceptors.push(["$q","$location","$localstorage",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.get("token")&&(t.headers.Authorization="Bearer "+n.get("token")),t},response:function(e){return e||t.when(e)}}}])}]),app.run(["$rootScope","$state","$stateParams",function(t,e,n){t.$state=e,t.$stateParams=n}]),trackDigests(app),angular.module("app").config(["localStorageServiceProvider",function(t){t.setPrefix("app").setStorageCookieDomain(-1!==document.location.hostname.search("uber")?"uber.org":"").setStorageType("localStorage")}]),angular.module("app").controller("UniversalController",["$filter","$window","$location","$scope","$rootScope","ngDialog","$anchorScroll","localStorageService","$http","$state","toastr","$interval","service_rideStatus","$ionicPopup","$ionicPopover","$timeout",function(t,e,n,r,i,o,a,s,u,c,l,d,p,m,f,g){i.main={uberRideRequestStatuses:p.uberRideRequestStatuses,classes:{body:"index"},userData:null,getUserData:function(){return Promise.resolve().then(function(){return u.post("http://www.pluschat.net/api/getUserData",{}).then(function(t){return t=t.data,i.main.responseStatusHandler(t),t.userData})["catch"](function(t){throw t=t.data,i.main.responseStatusHandler(t),t})}).then(function(t){return t?i.main.userData=t:i.main.userData=null,!0}).then(function(){i.main.userData?i.main.changeState("home",["index","register","login"],null):i.main.changeState("index",null,["index","register","login"])})["catch"](function(t){return console.log(t),!0})},getCurrentState:function(){return c.current.name},changeState:function(t,e,n){var r=i.main.getCurrentState();if(e)e.indexOf(r)>-1&&c.go(t);else if(n)-1==n.indexOf(r)&&c.go(t);else{if(!t)return!0;c.go(t)}},redirectToLogin:function(){e.location.href="/notLoggedIn"},reloadPage:function(){e.location.reload()},redirectToHome:function(){e.location.href="/"},redirectToPage:function(t){e.location.href=t},redirectToPreviousPage:function(){window.location.href=document.referrer},responseStatusHandler:function(e){t("responseFilter")(e)},showToast:function(t,e){return i.main.showIonicAlert("Info",e)},showIonicAlert:function(t,e){return m.alert({title:t,template:e})}},i.$on("$stateChangeSuccess",function(t,e,n,r,o){i.main.getUserData()}),r.$watch(function(){return i.main.userData},function(t,e){t&&""==t.uber.access_token&&i.main.changeState("connectToUber")})}]),angular.module("app").directive("uberConnect",["$rootScope","$http",function(t,e){return{restrict:"AE",link:function(n){n.uberConnect={isBusy:!1,status:"",getUberAuthorizationUrl:function(){return n.uberConnect.isBusy=!0,n.uberConnect.status="Connecting...",Promise.resolve().then(function(){return e.post("http://www.pluschat.net/api/getUberAuthorizationUrl",{}).then(function(e){return e=e.data,t.main.responseStatusHandler(e),e})["catch"](function(e){throw e=e.data,t.main.responseStatusHandler(e),e})}).then(function(e){return n.uberConnect.isBusy=!1,t.main.redirectToPage(e.url),!0})["catch"](function(t){return n.uberConnect.isBusy=!1,console.log(t),!0})}}}}}]),angular.module("app").controller("createAccountController",["$rootScope","$http",function(t,e){t.main.classes.body="account-crud"}]).directive("createAccountScope",["$rootScope","$http","$localstorage",function(t,e,n){return{restrict:"AE",link:function(r){function i(i){return e.post("http://www.pluschat.net/api/createAccount",i).then(function(e){return e=e.data,n.set("token",e.token),t.main.responseStatusHandler(e),!0})["catch"](function(e){return e=e.data,t.main.responseStatusHandler(e),r.registrationDetails.password1="",r.registrationDetails.password2="",!0})}r.createMain={isBusy:!1},r.registrationDetails={email:"",firstName:"",lastName:"",username:"",password1:"",password2:""},r.createAccount=function(t){return r.createMain.isBusy=!0,i(r.registrationDetails,t).then(function(){r.createMain.isBusy=!1})}}}}]),angular.module("app").directive("logoutScope",["$rootScope","$http","$localstorage",function(t,e,n){return{restrict:"AE",link:function(r){r.logout=function(){return Promise.resolve().then(function(){return e.post("http://www.pluschat.net/api/logoutClient",{}).then(function(e){return console.log(e),e=e.data,n.set("token",""),t.main.responseStatusHandler(e),t.main.userData=null,!0})["catch"](function(e){return e=e.data,t.main.responseStatusHandler(e),!0})})["catch"](function(t){return console.log(t),!0})}}}}]),angular.module("app").controller("signInController",["$rootScope","$http",function(t,e){t.main.classes.body="account-crud"}]).directive("signInScope",["$rootScope","$http","$localstorage",function(t,e,n){return{restrict:"AE",link:function(r){function i(i){return Promise.resolve().then(function(){return e.post("http://www.pluschat.net/api/localUserLogin",i)}).then(function(e){return e=e.data,n.set("token",e.token),t.main.responseStatusHandler(e),!0})["catch"](function(e){return e=e.data,r.loginFormModel.password="",t.main.responseStatusHandler(e),!0})}r.signInMain={isBusy:!1},r.loginFormModel={username:"",password:""},r.submitLocalLoginForm=function(){return r.signInMain.isBusy=!0,i(r.loginFormModel).then(function(){r.signInMain.isBusy=!1})}}}}]),angular.module("app").controller("homeCoreController",["$rootScope","$scope","$http",function(t,e,n){t.main.classes.body="homepage"}]).factory("$localstorage",["$window",function(t){return{set:function(e,n){t.localStorage[e]=n},get:function(e,n){return t.localStorage[e]||n},setObject:function(e,n){t.localStorage[e]=JSON.stringify(n)},getObject:function(e){return JSON.parse(t.localStorage[e]||"{}")}}}]).factory("service_uberProducts",["$interval","$rootScope","$http","$timeout",function(t,e,n,r){function i(t,r){return e.main&&e.main.userData?Promise.resolve().then(function(){if(t&&r)return!0;throw{code:600}}).timeout(55e3).then(function(){return n.post("http://www.pluschat.net/api/getProducts",{latitude:t,longitude:r}).then(function(t){return t=t.data,e.main.responseStatusHandler(t),t})["catch"](function(t){throw t=t.data,e.main.responseStatusHandler(t),t})}).then(function(t){return a=t.obj.products,t.obj.products})["catch"](function(t){if(600===t.code)return e.main.showToast("warning","We could not determine your precise location to list the available products in your area"),a=[],[];throw t})["catch"](o,function(t){return e.main.showToast("warning","Failed to get time estimates. Please check your internet connection."),a=[],[]})["catch"](function(t){return console.log(t),a=[],[]}):[]}var o=Promise.TimeoutError,a=null;return{getProducts:i,products:function(){return a}}}]).factory("service_uberPrices",["$interval","$rootScope","$http",function(t,e,n){function r(t,r,a,s){return e.main&&e.main.userData?Promise.resolve().then(function(){if(t&&r&&a&&s)return!0;throw{code:600}}).timeout(55e3).then(function(){return n.post("http://www.pluschat.net/api/getPriceEstimate",{start_latitude:t,start_longitude:r,end_latitude:a,end_longitude:s}).then(function(t){return t=t.data,e.main.responseStatusHandler(t),t})["catch"](function(t){throw t=t.data,e.main.responseStatusHandler(t),t})}).then(function(t){return o=t.obj.prices,t.obj.prices})["catch"](function(t){if(600===t.code)return e.main.showToast("warning","Some fields are missing"),o=[],[];throw t})["catch"](i,function(t){return e.main.showToast("warning","Failed to get time estimates. Please check your internet connection."),o=[],[]})["catch"](function(t){return console.log(t),o=[],[]}):[]}var i=Promise.TimeoutError,o=null;return{getPriceEstimates:r,priceEstimateArray:function(){return o}}}]).factory("service_uberTimeEstimates",["$interval","$rootScope","$http",function(t,e,n){function r(t,r){return e.main&&e.main.userData?Promise.resolve().then(function(){if(t&&r)return!0;throw{code:600}}).timeout(55e3).then(function(){return n.post("http://www.pluschat.net/api/getTimeEstimate",{start_latitude:t,start_longitude:r}).then(function(t){return t=t.data,e.main.responseStatusHandler(t),t})["catch"](function(t){throw t=t.data,e.main.responseStatusHandler(t),t})}).then(function(t){return o=t.obj.times,t.obj.times})["catch"](function(t){if(600===t.code)return e.main.showToast("warning","Some fields are missing"),o=[],[];throw t})["catch"](i,function(t){return e.main.showToast("warning","Failed to get time estimates. Please check your internet connection."),o=[],[]})["catch"](function(t){return console.log(t),o=[],[]}):[]}var i=Promise.TimeoutError,o=null;return{getTimeEstimates:r,timeEstimateArray:function(){return o}}}]).factory("service_rideStatus",["$interval","$rootScope","$http",function(t,e,n){function r(){return e.main&&e.main.userData?Promise.resolve().timeout(8e3).then(function(){return n.post("http://www.pluschat.net/api/getRideStatus",{}).then(function(t){return t=t.data,e.main.responseStatusHandler(t),t})["catch"](function(t){throw t=t.data,e.main.responseStatusHandler(t),t})}).then(function(t){var e=t.obj;return e?(e.driver&&(e.driver.ratingArray=new Array(Math.ceil(e.driver.rating))),a=e):(a=null,!0)})["catch"](function(t){if(600===t.code)return e.main.showToast("warning","Some fields are missing"),a;throw t})["catch"](o,function(t){return e.main.showToast("warning","Failed to get time estimates. Please check your internet connection."),a})["catch"](function(t){return console.log(t),a}).then(function(){i()}):[]}function i(){a&&e.main.changeState("rideStatus",null,["rideStatus"])}var o=Promise.TimeoutError,a=null,s={processing:"Processing",no_drivers_available:"No drivers available",accepted:"Accepted",arriving:"Arriving",in_progress:"In progress",driver_canceled:"Driver canceled",rider_canceled:"Rider canceled",completed:"Completed"};return t(function(){r()},1e4),r(),e.$on("$stateChangeSuccess",function(){a&&e.main.changeState("rideStatus",null,["rideStatus"])}),{rideStatus:function(){return a},getRideStatus:function(){return r()},uberRideRequestStatuses:s}}]),angular.module("app").directive("locationSearchBox",["$rootScope","$http",function(t,e){return{restrict:"AE",link:function(t,e,n){t.lat=angular.element(e.find(".details input.lat")).val(),t.lng=angular.element(e.find(".details input.lng")).val(),t.formatted_address=angular.element(e.find(".details input.formatted_address")).val(),angular.element(e.find("input.geoField")).geocomplete({details:angular.element(e.find(".details"))}).bind("geocode:result",function(){t.lat=angular.element(e.find(".details input.lat")).val(),t.lng=angular.element(e.find(".details input.lng")).val(),t.formatted_address=angular.element(e.find(".details input.formatted_address")).val(),t.$apply(n.locationUpdate)})}}}]),angular.module("app").controller("mapController",["$rootScope","$scope","$http","$interval","$timeout",function(t,e,n,r,i){function o(){angular.element("#map").css({height:angular.element(window).height(),margin:0,"padding-left":0})}angular.element(window).resize(function(){o()}),o(),GMaps.prototype._getMyPosition=function(e){return e._myLocation.lat&&e._myLocation.lng?{lat:e._myLocation.lat,lng:e._myLocation.lng}:Promise.resolve().then(function(){return new Promise(function(n,r){GMaps.geolocate({success:function(t){e._myLocation.lat=t.coords.latitude,e._myLocation.lng=t.coords.longitude,n({lat:e._myLocation.lat,lng:e._myLocation.lng})},error:function(e){t.main.showToast("warning","Geolocation failed"),console.log(e),n(null)},not_supported:function(){t.main.showToast("warning","Your browser does not support geolocation"),n(null)}})})})},GMaps.prototype._updateMyPosition=function(e){return new Promise(function(n,r){GMaps.geolocate({success:function(t){e._myLocation.lat=t.coords.latitude,e._myLocation.lng=t.coords.longitude,n(!0)},error:function(e){console.log(e),t.main.showToast("warning","We could not update your location..."),n(!0)}})})},GMaps.prototype._myLocation={lat:null,lng:null},GMaps.prototype._addMarker=function(t,e,n){return this.addMarker({lat:t,lng:e,title:n||""})},GMaps.prototype._addInfoWindowMarker=function(t,e,n){return this.addMarker({lat:t,lng:e,infoWindow:{content:"<p>"+n+"</p>"}})},GMaps.prototype._userMarker=null,GMaps.prototype._userInfoWindowMarker=null,GMaps.prototype._addUserMarker=function(){return this._userMarker=this.addMarker({lat:t.map._myLocation.lat,lng:t.map._myLocation.lat,title:""}),this._userMarker},GMaps.prototype._addUserInfoWindowMarker=function(e){return this._userInfoWindowMarker=this.addMarker({lat:t.map._myLocation.lat,lng:t.map._myLocation.lat,infoWindow:{content:"<p>"+e+"</p>"}}),this._userInfoWindowMarker},GMaps.prototype._moveMarker=function(t,e,n){t.setPosition(new google.maps.LatLng(e,n))},GMaps.prototype._updateUserMarker=function(){this._userMarker?this._moveMarker(this._userMarker,this._myLocation.lat,this._myLocation.lng):this._addUserMarker()},GMaps.prototype._updateUserInfoWindowMarker=function(t){this._userInfoWindowMarker?this._moveMarker(this._userInfoWindowMarker,this._myLocation.lat,this._myLocation.lng):this._addUserInfoWindowMarker(t)},GMaps.prototype._removeMarker=function(t){t.setMap(null)},GMaps.prototype._removeAllPresentMarkers=function(){this.removeMarkers()},GMaps.prototype._setCenter=function(t,e){this.setCenter(t,e)},GMaps.prototype._setCenterToMe=function(){this._myLocation.lat&&this._myLocation.lng&&this.setCenter(this._myLocation.lat,this._myLocation.lng)},GMaps.prototype._drawRoute=function(t,e){t&&e&&(t.length<2||e.length<2||(this.cleanRoute(),this.removeMarkers(),this.addMarker({lat:t[0],lng:t[1]}),this.addMarker({lat:e[0],lng:e[1]}),this.drawRoute({origin:t,destination:e,travelMode:"driving",strokeColor:"#09091A",strokeOpacity:.6,strokeWeight:6})))},t.map=new GMaps({div:"#map",lat:-12.043333,lng:-77.028333}),i(function(){o(),t.map._updateMyPosition(t.map).then(function(){t.map._setCenter(t.map._myLocation.lat,t.map._myLocation.lng),t.map._addUserMarker(t.map._myLocation.lat,t.map._myLocation.lng)}),e.$watch(function(){return t.map._myLocation.lat},function(){t.map._userMarker&&t.map._moveMarker(t.map._userMarker,t.map._myLocation.lat,t.map._myLocation.lng)}),r(function(){t.map._updateMyPosition&&t.map._updateMyPosition(t.map)},1e4),$(window).resize(function(){t.map.refresh()})},3e3)}]),angular.module("app").controller("priceEstimateController",["$rootScope","$scope","$http","$ionicPopover","$ionicSlideBoxDelegate",function(t,e,n,r,i){t.main.classes.body="priceEstimate",e.priceEstimatorCtrlMain={priceEstimateArray:[],showEstimates:!1},e.goToSlide=function(t){i.slide(parseInt(t))},e.nextSlide=function(t){i.next()},e.previousSlide=function(t){i.previous()}}]).directive("priceEstimator",["$rootScope","$http","service_uberPrices",function(t,e,n){return{restrict:"AE",link:function(e,r,i){e.priceEstimator={isBusy:!1,status:"",start_latitude:"",start_longitude:"",start_formatted_address:"",end_latitude:"",end_longitude:"",end_formatted_address:"",getPriceEstimates:function(){return e.priceEstimator.start_latitude&&e.priceEstimator.start_longitude&&e.priceEstimator.end_latitude&&e.priceEstimator.end_longitude?(e.priceEstimator.isBusy=!0,e.priceEstimator.status="Calculating...",Promise.resolve().then(function(){return n.getPriceEstimates(e.priceEstimator.start_latitude,e.priceEstimator.start_longitude,e.priceEstimator.end_latitude,e.priceEstimator.end_longitude)}).then(function(t){return e.priceEstimatorCtrlMain.priceEstimateArray=t,e.priceEstimator.isBusy=!1,e.priceEstimatorCtrlMain.showEstimates=!0,e.goToSlide(0),!0})["catch"](function(t){return e.priceEstimator.isBusy=!1,console.log(t),!0})):void 0}},e.updateStartLocation=function(n,r,i){n=parseFloat(n).toFixed(10),r=parseFloat(r).toFixed(10),i&&(i=i.toString()),n&&r&&(e.priceEstimator.start_latitude=n,e.priceEstimator.start_longitude=r,e.priceEstimator.start_formatted_address=i,t.map._addMarker(n,r,i),t.map._setCenter(n,r),e.drawRoute())},e.updateEndLocation=function(n,r,i){n=parseFloat(n).toFixed(10),r=parseFloat(r).toFixed(10),i&&(i=i.toString()),n&&r&&(e.priceEstimator.end_latitude=n,e.priceEstimator.end_longitude=r,e.priceEstimator.end_formatted_address=i,t.map._addMarker(n,r,i),e.drawRoute())},e.drawRoute=function(){e.priceEstimator.start_latitude&&e.priceEstimator.end_latitude&&(t.map._setCenter(e.priceEstimator.start_latitude,e.priceEstimator.start_longitude),t.map._drawRoute([e.priceEstimator.start_latitude,e.priceEstimator.start_longitude],[e.priceEstimator.end_latitude,e.priceEstimator.end_longitude]))},e.startAtMyLocation=function(){return Promise.resolve().then(function(){return t.main.userLocation.latitude&&t.main.userLocation.longitude?[t.main.userLocation.latitude,t.main.userLocation.longitude]:t.map._getMyPosition(t.map).then(function(){return t.main.userLocation.latitude&&t.main.userLocation.longitude?[t.main.userLocation.latitude,t.main.userLocation.longitude]:(t.main.showToast("warning","Could not find your position"),null)})}).then(function(t){t&&(e.priceEstimator.start_latitude=t[0],e.priceEstimator.start_longitude=t[1])})["catch"](function(e){console.log(e),t.main.showToast("warning","An error occurred while trying to pin point your location")})},e.endAtMyLocation=function(){return Promise.resolve().then(function(){return t.main.userLocation.latitude&&t.main.userLocation.longitude?[t.main.userLocation.latitude,t.main.userLocation.longitude]:t.map._getMyPosition(t.map).then(function(){return t.main.userLocation.latitude&&t.main.userLocation.longitude?[t.main.userLocation.latitude,t.main.userLocation.longitude]:(t.main.showToast("warning","Could not find your position"),null)})}).then(function(t){t&&(e.priceEstimator.end_latitude=t[0],e.priceEstimator.end_longitude=t[1])})["catch"](function(e){console.log(e),t.main.showToast("warning","An error occurred while trying to pin point your location")})}}}}]),angular.module("app").controller("requestUberController",["$rootScope","$scope","$http","$ionicSlideBoxDelegate",function(t,e,n,r){t.main.classes.body="requestUber",e.requestUberControllerMain={priceEstimateArray:[],timeEstimateArray:[],products:[],showStatus:!1},e.goToSlide=function(t){r.slide(parseInt(t))},e.nextSlide=function(t){r.next()},e.previousSlide=function(t){r.previous()}}]).directive("requestUberDirective",["$rootScope","$http","$interval","service_uberProducts","service_uberPrices","service_uberTimeEstimates","service_rideStatus",function(t,e,n,r,i,o,a){return{restrict:"AE",link:function(s,u,c){s.requestUberMain={isBusy:!1,status:"",start_latitude:"",start_longitude:"",start_formatted_address:"",end_latitude:"",end_longitude:"",end_formatted_address:"",products:[],product_id:"",selectedProductPriceEstimate:{},selectedProduct:{},changeProductId:function(t,e){t&&(s.requestUberMain.product_id=t,s.requestUberControllerMain.products.forEach(function(e){e.product_id==t&&(s.requestUberMain.selectedProduct=e)}),s.requestUberControllerMain.priceEstimateArray.forEach(function(t){t.localized_display_name.toLowerCase()==e.toLowerCase()&&(s.requestUberMain.selectedProductPriceEstimate=t)}),s.requestUberControllerMain.timeEstimateArray.forEach(function(t){t.display_name.toLowerCase()==e.toLowerCase()&&(s.requestUberMain.selectedProduct.estimate=Math.ceil(t.estimate/60))}))},requestUber:function(){return s.requestUberMain.isBusy=!0,s.requestUberMain.status="Requesting...",Promise.resolve().then(function(){if(s.requestUberMain.start_latitude&&s.requestUberMain.start_longitude&&s.requestUberMain.end_latitude&&s.requestUberMain.end_longitude&&s.requestUberMain.product_id)return!0;throw{code:600}}).then(function(){return e.post("http://www.pluschat.net/api/requestUber",{start_latitude:s.requestUberMain.start_latitude,start_longitude:s.requestUberMain.start_longitude,end_latitude:s.requestUberMain.end_latitude,end_longitude:s.requestUberMain.end_longitude,product_id:s.requestUberMain.product_id}).then(function(e){return e=e.data,t.main.responseStatusHandler(e),e})["catch"](function(e){throw e=e.data,t.main.responseStatusHandler(e),e})}).then(function(t){return s.requestUberMain.isBusy=!1,a.getRideStatus(),!0})["catch"](function(e){if(600!==e.code)throw e;return t.main.showToast("warning","Some fields are missing"),s.requestUberMain.isBusy=!1,!0})["catch"](function(t){return s.requestUberMain.isBusy=!1,console.log(t),!0})},getPriceEstimates:function(){return s.requestUberMain.start_latitude&&s.requestUberMain.start_longitude&&s.requestUberMain.end_latitude&&s.requestUberMain.end_longitude?(s.requestUberMain.isBusy=!0,s.requestUberMain.status="Getting cost estimates...",Promise.resolve().then(function(){return i.getPriceEstimates(s.requestUberMain.start_latitude,s.requestUberMain.start_longitude,s.requestUberMain.end_latitude,s.requestUberMain.end_longitude)}).then(function(t){return s.requestUberControllerMain.priceEstimateArray=t,s.requestUberMain.isBusy=!1,!0})["catch"](function(t){return s.requestUberMain.isBusy=!1,console.log(t),!0})):void 0},updateTimeEstimates:function(){s.requestUberMain.start_latitude&&s.requestUberMain.start_longitude&&(console.log("Updating all eta"),Promise.resolve().then(function(){return o.getTimeEstimates(s.requestUberMain.start_latitude,s.requestUberMain.start_longitude).then(function(t){return s.requestUberControllerMain.timeEstimateArray=t,!0})}))}},n(function(){s.requestUberMain.updateTimeEstimates()},6e4),s.requestUberMain.updateTimeEstimates(),s.updateStartLocation=function(e,n,i){e=parseFloat(e).toFixed(10),n=parseFloat(n).toFixed(10),i&&(i=i.toString()),e&&n&&(s.requestUberMain.start_latitude=e,s.requestUberMain.start_longitude=n,s.requestUberMain.start_formatted_address=i,t.map._addMarker(e,n,i),t.map._setCenter(e,n),s.drawRoute(),Promise.resolve().then(function(){return r.getProducts(e,n).then(function(t){return s.requestUberControllerMain.products=t,!0})}),s.requestUberMain.getPriceEstimates(),s.requestUberMain.updateTimeEstimates())},s.updateEndLocation=function(e,n,r){e=parseFloat(e).toFixed(10),n=parseFloat(n).toFixed(10),r&&(r=r.toString()),e&&n&&(s.requestUberMain.end_latitude=e,s.requestUberMain.end_longitude=n,s.requestUberMain.end_formatted_address=r,t.map._addMarker(e,n,r),s.drawRoute(),s.requestUberMain.getPriceEstimates())},s.drawRoute=function(){s.requestUberMain.start_latitude&&s.requestUberMain.end_latitude&&(t.map._setCenter(s.requestUberMain.start_latitude,s.requestUberMain.start_longitude),t.map._drawRoute([s.requestUberMain.start_latitude,s.requestUberMain.start_longitude],[s.requestUberMain.end_latitude,s.requestUberMain.end_longitude]))},s.startAtMyLocation=function(){return Promise.resolve().then(function(){return t.main.userLocation.latitude&&t.main.userLocation.longitude?[t.main.userLocation.latitude,t.main.userLocation.longitude]:t.map._getMyPosition(t.map).then(function(){return t.main.userLocation.latitude&&t.main.userLocation.longitude?[t.main.userLocation.latitude,t.main.userLocation.longitude]:(t.main.showToast("warning","Could not find your position"),null)})}).then(function(t){return t&&(s.requestUberMain.start_latitude=t[0],s.requestUberMain.start_longitude=t[1]),!0})["catch"](function(e){console.log(e),t.main.showToast("warning","An error occurred while trying to pin point your location")})},s.endAtMyLocation=function(){return Promise.resolve().then(function(){return t.main.userLocation.latitude&&t.main.userLocation.longitude?[t.main.userLocation.latitude,t.main.userLocation.longitude]:t.map._getMyPosition(t.map).then(function(){return t.main.userLocation.latitude&&t.main.userLocation.longitude?[t.main.userLocation.latitude,t.main.userLocation.longitude]:(t.main.showToast("warning","Could not find your position"),null)})}).then(function(t){t&&(s.requestUberMain.end_latitude=t[0],s.requestUberMain.end_longitude=t[1])})["catch"](function(e){console.log(e),t.main.showToast("warning","An error occurred while trying to pin point your location")})}}}}]),angular.module("app").controller("uberRideStatusController",["$rootScope","$scope","$http","$ionicSlideBoxDelegate",function(t,e,n,r){t.main.classes.body="rideStatus",e.uberRideStatusControllerMain={showStatus:!0},e.goToSlide=function(t){r.slide(parseInt(t))},e.nextSlide=function(t){r.next()},e.previousSlide=function(t){r.previous()}}]).directive("uberRideStatusDirective",["$rootScope","$http","service_rideStatus","$interval","$timeout",function(t,e,n,r,i){return{restrict:"AE",link:function(o,a,s){function u(){var e=n.rideStatus();e?(o.uberRideStatusMain.rideStatus=e,o.uberRideStatusMain.start_lat=e.lastRide.startLatitude,o.uberRideStatusMain.start_lng=e.lastRide.startLongitude,o.uberRideStatusMain.end_lat=e.lastRide.endLatitude,o.uberRideStatusMain.end_lng=e.lastRide.endLongitude,t.map._updateUserInfoWindowMarker(t.main.userData.firstName),"in_progress"==e.status?t.map._setCenter(o.uberRideStatusMain.driver_latitude,o.uberRideStatusMain.driver_longitude):t.map._setCenterToMe(),e.location&&(o.uberRideStatusMain.driver_latitude=parseFloat(e.location.latitude).toFixed(10),o.uberRideStatusMain.driver_longitude=parseFloat(e.location.longitude).toFixed(10),o.uberRideStatusMain.driver_info_window_marker?(t.map._removeMarker(o.uberRideStatusMain.driver_info_window_marker),o.uberRideStatusMain.driver_info_window_marker=t.map._addInfoWindowMarker(o.uberRideStatusMain.driver_latitude,o.uberRideStatusMain.driver_longitude,"Driver")):o.uberRideStatusMain.driver_info_window_marker=t.map._addInfoWindowMarker(o.uberRideStatusMain.driver_latitude,o.uberRideStatusMain.driver_longitude,"Driver"))):(o.uberRideStatusMain.rideStatus=null,t.main&&t.main.userData&&t.map._updateUserInfoWindowMarker(t.main.userData.firstName),t.map._setCenterToMe())}t.map._removeAllPresentMarkers(),o.uberRideStatusMain={rideStatus:null,driver_latitude:null,driver_longitude:null,driver_info_window_marker:null,start_lat:null,start_lng:null,end_lat:null,end_lng:null,updateUberRequestSandbox:function(){Promise.resolve().then(function(){return Promise.delay(15e3)}).then(function(){return e.post("http://www.pluschat.net/api/updateUberRequestSandbox",{status:"accepted"}).then(function(e){return e=e.data,t.main.responseStatusHandler(e),!0})["catch"](function(e){return e=e.data,t.main.responseStatusHandler(e),!0})}).then(function(){return Promise.delay(3e4)}).then(function(){return e.post("http://www.pluschat.net/api/updateUberRequestSandbox",{status:"arriving"}).then(function(e){return e=e.data,t.main.responseStatusHandler(e),!0})["catch"](function(e){return e=e.data,t.main.responseStatusHandler(e),!0})}).then(function(){return Promise.delay(15e3)}).then(function(){return e.post("http://www.pluschat.net/api/updateUberRequestSandbox",{status:"in_progress"}).then(function(e){return e=e.data,t.main.responseStatusHandler(e),!0})["catch"](function(e){return e=e.data,t.main.responseStatusHandler(e),!0})}).then(function(){return Promise.delay(45e3)}).then(function(){return e.post("http://www.pluschat.net/api/updateUberRequestSandbox",{status:"completed"}).then(function(e){return e=e.data,t.main.responseStatusHandler(e),!0})["catch"](function(e){return e=e.data,t.main.responseStatusHandler(e),!0})})["catch"](function(t){return console.log(t),!0})}},o.uberRideStatusMain.updateUberRequestSandbox(),i(function(){o.$watch(function(){return o.uberRideStatusMain.start_lat},function(e){e&&(t.map._addMarker(parseFloat(o.uberRideStatusMain.start_lat).toFixed(10),parseFloat(o.uberRideStatusMain.start_lng).toFixed(10)),t.map._addMarker(parseFloat(o.uberRideStatusMain.end_lat).toFixed(10),parseFloat(o.uberRideStatusMain.end_lng).toFixed(10)),t.map._setCenterToMe())})},3e3),i(function(){r(function(){u()},5e3),u()},3e3)}}}]),angular.module("app").controller("indexController",["$rootScope","$http",function(t,e){t.main.classes.body="index"}]).directive("indexnScope",["$rootScope","$http",function(t,e){return{restrict:"AE",link:function(t){}}}]),angular.module("app").filter("responseFilter",["$q","$log","$window","$rootScope",function(t,e,n,r){return function(t){if(null!==t&&"object"==typeof t){if(t.redirect)return t.redirectPage&&(n.location.href=t.redirectPage),void(t.redirectState&&r.main.changeState(t.redirectState));if(t.reload)return void r.main.reloadPage();if(t.notify&&t.type&&t.msg)return void r.main.showIonicAlert("Info",t.msg);if(t.dialog&&t.id){switch(t.id){case"not-authorized":r.main.showIonicAlert("Info","You are not authorized to be/access this page or resource.");break;case"sign-in":r.main.showIonicAlert("Info","Please sign in to continue.").then(function(){r.main.changeState("login")})}return}if(t.banner&&t.bannerClass&&t.msg)return void r.main.showIonicAlert("Info",t.msg);if(t.signInBanner&&t.bannerClass&&t.msg)return void r.main.showIonicAlert("Info",t.msg);if(t.registrationBanner&&t.bannerClass&&t.msg)return void r.main.showIonicAlert("Info",t.msg);t.reason&&e.warn(t.reason)}}}]);
//# sourceMappingURL=app.min.js.map
