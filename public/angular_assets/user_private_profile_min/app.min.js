function trackDigests(n){n.run(["$rootScope",function(n){Promise.setScheduler(function(e){n.$evalAsync(e)})}])}var app=angular.module("app",["ngSanitize","ui.bootstrap","angularUtils.directives.dirDisqus","ngTagsInput","ngFileUpload","toastr","ngDialog","ui.select","ngTable","LocalStorageModule"]).config(["$locationProvider",function(n){n.html5Mode({enabled:!0})}]);trackDigests(app),angular.module("app").directive("createAccountScope",["$rootScope","$http",function(n,e){return{restrict:"AE",link:function(t){function o(o){return e.post("/createAccount",o).then(function(e){return e=e.data,n.main.responseStatusHandler(e),!0})["catch"](function(e){return e=e.data,n.main.responseStatusHandler(e),t.registrationDetails.password1="",t.registrationDetails.password2="",!0})}t.createMain={isBusy:!1},t.registrationDetails={email:"",firstName:"",lastName:"",username:"",password1:"",password2:""},t.createAccount=function(n){return t.createMain.isBusy=!0,o(t.registrationDetails,n).then(function(){t.createMain.isBusy=!1})}}}}]),angular.module("app").directive("resetPasswordScope",["$rootScope","$http",function(n,e){return{restrict:"AE",link:function(t){t.resetMain={isBusy:!1},t.resetFormModel={email:"",newPassword:"",confirmNewPassword:""},t.submitResetPasswordEmail=function(){return t.resetMain.isBusy=!0,e.post("/api/resetPassword/email",t.resetFormModel).then(function(e){e=e.data,n.main.responseStatusHandler(e)})["catch"](function(e){e=e.data,n.main.responseStatusHandler(e),t.resetFormModel.email="",t.resetFormModel.newPassword="",t.resetFormModel.confirmNewPassword="",t.resetMain.isBusy=!1})}}}}]),angular.module("app").directive("signInScope",["$rootScope","$http",function(n,e){return{restrict:"AE",link:function(t){function o(o,a){return Promise.resolve().then(function(){return a?e.post("/localUserLogin?lastpage="+document.referrer,o):e.post("/localUserLogin",o)}).then(function(e){return e=e.data,n.main.responseStatusHandler(e),!0})["catch"](function(e){return e=e.data,t.loginFormModel.password="",n.main.responseStatusHandler(e),!0})}t.signInMain={isBusy:!1},t.loginFormModel={username:"",password:""},t.submitLocalLoginForm=function(n){return t.signInMain.isBusy=!0,o(t.loginFormModel,n).then(function(){t.signInMain.isBusy=!1})}}}}]),angular.module("app").directive("imageAdDirective",["$rootScope","$http",function(n,e){return{restrict:"AE",link:function(t,o,a){function i(){Promise.resolve().then(function(){return e.post("/ad/imageAdHtml",{size:r})["catch"](function(e){throw e=e.data,n.main.responseStatusHandler(e),e}).then(function(e){return e=e.data,n.main.responseStatusHandler(e),e})}).then(function(n){o.empty(),o.append(n)})["catch"](function(n){console.log(n)})}var r=a.adsize.toString(),c=s.words(a.display),u=$(window).width();u>=1200&&c.indexOf("lg")>-1?i():u>=992&&1200>u&&c.indexOf("md")>-1?i():u>=768&&992>u&&c.indexOf("sm")>-1?i():768>u&&c.indexOf("xs")>-1&&i()}}}]),angular.module("app").config(["localStorageServiceProvider",function(n){n.setPrefix("app").setStorageCookieDomain(-1!==document.location.hostname.search("africanexponent")?"africanexponent.com":"").setStorageType("localStorage")}]),angular.module("app").controller("UniversalController",["$filter","$window","$location","$scope","$rootScope","ngDialog","$anchorScroll","$sce","localStorageService","$http",function(n,e,t,o,a,i,r,s,c,u){function l(){return-1!==document.location.hostname.search("africanexponent")?"//www.africanexponent.com":-1!==document.location.hostname.search("amazonaws")?"//ec2-54-85-41-117.compute-1.amazonaws.com:3000":t.port()?"http://localhost:"+t.port():"http://localhost"}a.main={userLocationData:null,getUserLocationData:function(){Promise.resolve().then(function(){return new Promise(function(n,e){function t(){function t(e){var t={country:e.address.country};a.main.saveKeyToCookie("userLocation",t,1),n(!0)}function o(n){var t={country:null};a.main.saveKeyToCookie("userLocation",t,1),e(n)}geolocator.locateByIP(t,o,2)}if(a.main.checkCookieIsEnabled()){var o;(o=a.main.getKeyFromCookie("userLocation",604800))&&o.hasOwnProperty("country")&&o.country?n(!0):t()}else{console.log("Cookie not supported");var i={country:null};a.main.saveKeyToCookie("userLocation",i,7),n(!0)}})})["catch"](function(n){if(!n.msg)throw n;console.log(n.msg)})["catch"](function(n){console.log(n)})},checkLocalStorageSupport:function(){return c.isSupported?!0:!1},checkCookieIsEnabled:function(){return c.cookie.isSupported?!0:!1},saveToLocalStorage:function(n,e){var t={value:e,timestamp:(new Date).getTime()};return c.set(n,t)},getFromLocalStorage:function(n,e){if(e||(e=86400),a.main.checkIfExistsOnLocalStorage(n)){var t=c.get(n),o=t.timestamp,i=(new Date).getTime().toString();return i-o>1e3*e?(a.main.removeFromLocalStorage([n]),!1):t.value}return!1},saveKeyToCookie:function(n,e,t){t||(t=2);var o={value:e,timestamp:(new Date).getTime()};return o=JSON.stringify(o),c.cookie.set(n,o,t)},getKeyFromCookie:function(n,e){e||(e=86400);var t=c.cookie.get(n);if(t){var o=t.timestamp,i=(new Date).getTime().toString();return i-o>1e3*e?(a.main.removeKeyFromCookie(n),!1):t.value}return!1},checkIfExistsOnLocalStorage:function(n){for(var e=c.keys(),t=e.length,o=!1,a=0;t>a;a++)if(e[a]==n){o=!0;break}return o},removeFromLocalStorage:function(n,e){return e?c.clearAll():(n.forEach(function(n){c.remove(n)}),!0)},removeKeyFromCookie:function(n){return c.cookie.remove(n)},windowWidth:$(window).width(),bootStrapWidth:function(n){return n=parseInt(n),n>=1200?"lg":n>=992&&1200>n?"md":n>=768&&992>n?"sm":768>n?"xs":void 0},trustAsHtml:function(n){return s.trustAsHtml(n)},intersectionArray:function(n,e){return _.intersection(n,e)},getAmazonS3Url:function(n){var e="https://assets.africanexponent.com/";return e+n},defaultProfilePicture:"/public/imgsmin/default_avatar/default_avatar_red_462_462.png",isAdmin:function(n){var e=[77,100,101];return 0===n.adminLevels.length?!1:_.intersection(n.adminLevels,e).length>0},assetsDomainWithSlash:function(){return"https://assets.africanexponent.com/"},goToTop:function(){t.hash("pageTop"),r()},back:function(){a.back()},responseStatusHandler:function(e){n("responseFilter")(e)},showToast:function(n,e){a.showToast(n,e)},clearBanners:function(){a.$broadcast("clearBanners")},redirectToAbout:function(){e.location.href="/about"},redirectToLogin:function(){e.location.href="/notLoggedIn"},reloadPage:function(){e.location.reload()},redirectToHome:function(){e.location.href="/"},redirectToPage:function(n){e.location.href=l()+n},redirectToPreviousPage:function(){window.location.href=document.referrer},showExecuting:function(n){var e;return e=n&&"string"==typeof n&&0!==n.length?n+"...":"Performing action...",i.open({data:{message:e},templateUrl:"views/dialogs/executing.html",className:"ngdialog-theme-default",overlay:!0,showClose:!1,closeByEscape:!1,closeByDocument:!1,cache:!0,trapFocus:!1,preserveFocus:!0})}},a.main.getUserLocationData(),a.back=function(){window.history.back()}}]),angular.module("app").directive("resendEmailScope",["$rootScope","$http",function(n,e){return{restrict:"AE",link:function(t){function o(n){return e.post("/resendConfirmationEmail",{userUniqueCuid:n})}t.resendConfirmationEmail=function(e){var t=n.main.showExecuting("Sending Email");o(e).success(function(e){t.close(),n.main.responseStatusHandler(e)}).error(function(e){t.close(),n.main.responseStatusHandler(e)})}}}}]),angular.module("app").filter("responseFilter",["$q","$log","$window","$rootScope","ngDialog",function(n,e,t,o,a){return function(n){function i(n,e,t){return{show:n?!0:!1,bannerClass:e,msg:t}}function r(){a.open({template:"/dialog/not-authorized.html",className:"ngdialog-theme-default",overlay:!0,showClose:!1,closeByEscape:!0,closeByDocument:!0,cache:!1,trapFocus:!0,preserveFocus:!0})}function s(n){a.openConfirm({data:{message:n},template:"/dialog/sign-in.html",className:"ngdialog-theme-default",overlay:!0,showClose:!1,closeByEscape:!1,closeByDocument:!1,cache:!0,trapFocus:!0,preserveFocus:!0}).then(function(){o.main.redirectToPage("/notLoggedIn")},function(){o.main.redirectToPage("/about")})}if(null!==n&&"object"==typeof n){if(n.redirect&&n.redirectPage&&(t.location.href=n.redirectPage),n.reload&&o.main.reloadPage(),n.notify&&n.type&&n.msg&&o.showToast(n.type,n.msg),n.dialog&&n.id)switch(n.id){case"not-authorized":r();break;case"sign-in":s(n.msg)}n.banner&&n.bannerClass&&n.msg&&o.$broadcast("universalBanner",i(!0,n.bannerClass,n.msg)),n.signInBanner&&n.bannerClass&&n.msg&&o.$broadcast("signInBanner",i(!0,n.bannerClass,n.msg)),n.registrationBanner&&n.bannerClass&&n.msg&&o.$broadcast("registrationBanner",i(!0,n.bannerClass,n.msg)),n.reason&&e.warn(n.reason)}return!0}}]),angular.module("app").factory("globals",["$location","$http",function(n,e){var t={};return{userData:function(n){return n?t=n:t},userDataFromServer:function(){return e.get("/api/getUserData")},getLocationHost:function(){return-1!==document.location.hostname.search("africanexponent")?"//www.africanexponent.com":-1!==document.location.hostname.search("amazonaws")?"//ec2-54-85-41-117.compute-1.amazonaws.com:3000":n.port()?"http://localhost:"+n.port():"http://localhost"}}}]),angular.module("app").directive("toastrDirective",["$rootScope","toastr",function(n,e){return{restrict:"AE",link:function(){n.showToast=function(n,t){switch(n){case"success":e.clear(),e.success(t);break;case"warning":e.clear(),e.warning(t,"Warning",{closeButton:!0,tapToDismiss:!0});break;case"error":e.clear(),e.error(t,"Error",{closeButton:!0,tapToDismiss:!0,timeOut:!1});break;default:e.clear()}},n.clearToasts=function(){e.clear()}}}}]).directive("signInBannerScope",["$rootScope",function(n){return{restrict:"AE",link:function(e){e.signInBanner={show:!1,bannerClass:"",msg:""},n.$on("signInBanner",function(n,t){e.signInBanner=t}),n.$on("clearBanners",function(){e.signInBanner={show:!1,bannerClass:"",msg:""}})}}}]).directive("registrationBannerScope",["$rootScope",function(n){return{restrict:"AE",link:function(e){e.registrationBanner={show:!1,bannerClass:"",msg:""},n.$on("registrationBanner",function(n,t){e.registrationBanner=t}),n.$on("clearBanners",function(){e.registrationBanner={show:!1,bannerClass:"",msg:""}})}}}]),angular.module("app").directive("universalBannerScope",["$rootScope","globals",function(n){return{restrict:"AE",link:function(e){e.universalBanner={show:!1,bannerClass:"",msg:""},n.$on("universalBanner",function(n,t){e.universalBanner=t}),n.$on("clearBanners",function(){e.universalBanner={show:!1,bannerClass:"",msg:""}})}}}]),angular.module("app").directive("postTopicScope",["$rootScope","$http",function(n,e){return{restrict:"AE",link:function(t){function o(e){t.mainTopicModel={topic:t.theModel.topic,requestedPage:e},t.mainTopicModel.topic&&t.mainTopicModel.requestedPage&&(t.buttonLoading(),a(t.mainTopicModel).success(function(e){n.main.responseStatusHandler(e),t.theModel.pageNumber++,angular.element("#appendNextPosts").replaceWith(e),t.finishedLoading()}).error(function(e){n.main.responseStatusHandler(e),t.finishedLoading()}))}function a(n){var t=n.topic,o=n.requestedPage;return e.get("/partial/topic/"+t+"?page="+parseInt(o))}t.theModel=JSON.parse(t.model),t.showMore=function(){o(parseInt(t.theModel.pageNumber)+1)},t.buttonLoading=function(){$("#showMoreBtn").button("loading")},t.finishedLoading=function(){$("#showMoreBtn").button("reset")}}}}]),angular.module("app").controller("EditDetailsController",["$filter","$window","$location","$scope","$rootScope","$http","ngDialog",function(n,e,t,o,a,i,r){o.main={mainCollapse:{fullName:!0,email:!0,username:!0,statusLine:!0,biography:!0},collapseAll:function(){for(var n in this.mainCollapse)this.mainCollapse.hasOwnProperty(n)&&(this.mainCollapse[n]=!0)},userData:{},userEditModel:{firstName:"",lastName:"",email:"",username:"",statusLine:"",biography:""},contentHasBeenEdited:!1,isLoading:!0,showSpinner:!1,showDone:!1,isBusy:!1,busy:function(){this.showSpinner=!0,this.showDone=!1,this.isBusy=!0},done:function(){var n=this;n.showSpinner=!1,n.isBusy=!1,n.showDone=!0,Promise.delay(2e3).then(function(){n.showDone=!1})},update:function(){Promise.resolve().then(function(){return o.main.busy(),Promise.delay(1e3)}).then(function(){var n={};return o.main.userEditModel.firstName.length>0&&(n.firstName=o.main.userEditModel.firstName),o.main.userEditModel.lastName.length>0&&(n.lastName=o.main.userEditModel.lastName),o.main.userEditModel.email.length>0&&(n.email=o.main.userEditModel.email),o.main.userEditModel.username.length>0&&(n.username=o.main.userEditModel.username),o.main.userEditModel.statusLine.length>0&&(n.statusLine=o.main.userEditModel.statusLine),o.main.userEditModel.biography.length>0&&(n.biography=o.main.userEditModel.biography),i.post("/api/updateUserDetails",{data:n})}).then(function(n){return n=n.data,a.main.responseStatusHandler(n),o.main.getUserData()}).then(function(){o.main.collapseAll(),o.main.done()})["catch"](function(n){n=n.data,a.main.responseStatusHandler(n),o.main.done()})},passwordEditModel:{oldPassword:"",newPassword:"",confirmNewPassword:""},updateUserPassword:function(){return this.passwordEditModel.oldPassword&&this.passwordEditModel.newPassword&&this.passwordEditModel.confirmNewPassword?Promise.resolve().then(function(){return o.main.busy(),Promise.delay(1e3)}).then(function(){var n={oldPassword:o.main.passwordEditModel.oldPassword,newPassword:o.main.passwordEditModel.newPassword,confirmNewPassword:o.main.passwordEditModel.confirmNewPassword};return i.post("/api/updateUserPassword",{data:n})}).then(function(n){n=n.data,a.main.responseStatusHandler(n)}).then(function(){o.main.passwordEditModel.oldPassword="",o.main.passwordEditModel.newPassword="",o.main.passwordEditModel.confirmNewPassword="",o.main.done()})["catch"](function(n){n=n.data,a.main.responseStatusHandler(n),o.main.done()}):void 0},getUserData:function(){return Promise.resolve().then(function(){return i.get("/api/getUserData")}).then(function(n){return n=n.data,n.userData?(o.main.userData=n.userData,Promise.delay(1e3).then(function(){o.main.isLoading=!1})):void a.main.redirectToLogin()})}},o.main.getUserData()["catch"](function(n){n=n.data,a.main.responseStatusHandler(n),o.main.done()}),o.$watch(function(){return o.main.mainCollapse},function(n,e){var t=!1;if(n)for(var a in n)n.hasOwnProperty(a)&&n[a]===!1&&(t=!0);o.main.contentHasBeenEdited=t},!0)}]),angular.module("app").directive("socialDirective",["$rootScope","globals","$http",function(n,e,t){return{restrict:"AE",link:function(e,o,a){e.social={showSpinner:!1,isBusy:function(){this.showSpinner=!0,e.main.busy()},done:function(){this.showSpinner=!1,e.main.done()},deleteConnectedService:function(o){return e.social.isBusy(),Promise.resolve().then(function(){if(o)return!0;throw{code:500,msg:"serviceName = "+o}}).then(function(){return t.post("/api/deleteConnectedService",{serviceName:o}).then(function(e){return e=e.data,n.main.responseStatusHandler(e),e.theUser})["catch"](function(e){throw e=e.data,n.main.responseStatusHandler(e),e})}).then(function(n){return e.main.userData.social=n.social,!0}).then(function(){return"facebook"===o?new Promise(function(n,e){FB.getLoginStatus(function(e){"connected"===e.status?FB.logout(function(e){n(!0)}):n(!0)})}):!0})["catch"](function(n){return console.log(n),!0}).then(function(){e.social.done()})}};var i={credentials:{},profile:{}};e.connectToFacebook=function(){return e.social.isBusy(),Promise.resolve().then(function(){return new Promise(function(n,e){FB.login(function(e){n(e)})})}).then(function(n){if("connected"!==n.status)throw{code:401};return i.credentials=n.authResponse,i.credentials.dateConnected=(new Date).getTime(),!0}).then(function(){return new Promise(function(n,e){FB.api("/me/permissions",function(t){for(var o=t.data,a=!1,i=0;i<o.length;i++)if("public_profile"==o[i].permission){a="granted"===o[i].status?!0:!1;break}a?n(!0):e({code:401})})})}).then(function(){return new Promise(function(n,e){FB.api("/me",function(e){n(e)})})}).then(function(n){if(n.id)return i.profile=n,!0;throw{msg:"profile = "+n,code:500}}).then(function(){return t.post("/api/updateUserFacebook",i).then(function(e){return e=e.data,n.main.responseStatusHandler(e),e.theUser})["catch"](function(e){throw e=e.data,n.main.responseStatusHandler(e),e})}).then(function(n){return e.main.userData.social=n.social,!0})["catch"](function(n){return console.log(n),!0}).then(function(){e.social.done()})}}}}]),angular.module("app").directive("biographyDirective",["$rootScope","globals","$http","Upload","$interval",function(n,e,t,o,a){return{restrict:"AE",link:function(n,e,t){n.editBiography=function(){Promise.resolve().then(function(){return n.main.busy(),Promise.delay(3e3)}).then(function(){n.main.mainCollapse.biography=!1}).then(function(){n.main.done()})},n.cancelBiography=function(){Promise.resolve().then(function(){return n.main.busy(),Promise.delay(1e3)}).then(function(){n.main.biography=""}).then(function(){n.main.mainCollapse.biography=!0}).then(function(){n.main.done()})}}}}]),angular.module("app").directive("emailDirective",["$rootScope","globals","$http",function(n,e,t){return{restrict:"AE",link:function(n,e,t){n.editEmail=function(){Promise.resolve().then(function(){return n.main.busy(),Promise.delay(3e3)}).then(function(){n.main.mainCollapse.email=!1}).then(function(){n.main.done()})},n.cancelEmail=function(){Promise.resolve().then(function(){return n.main.busy(),Promise.delay(1e3)}).then(function(){n.main.email=""}).then(function(){n.main.mainCollapse.email=!0}).then(function(){n.main.done()})}}}}]),angular.module("app").directive("fullName",["$rootScope","globals","$http","Upload","$interval",function(n,e,t,o,a){return{restrict:"AE",link:function(n,e,t){n.editFullName=function(){Promise.resolve().then(function(){return n.main.busy(),Promise.delay(3e3)}).then(function(){n.main.mainCollapse.fullName=!1}).then(function(){n.main.done()})},n.cancelFullName=function(){Promise.resolve().then(function(){return n.main.busy(),Promise.delay(1e3)}).then(function(){n.main.firstName="",n.main.lastName=""}).then(function(){n.main.mainCollapse.fullName=!0}).then(function(){n.main.done()})}}}}]),angular.module("app").directive("editPasswordDirective",["$rootScope","globals","$http",function(n,e,t){return{restrict:"AE",link:function(n,e,t){n.updatePassword=function(){Promise.resolve().then(function(){return n.main.updateUserPassword()})}}}}]),angular.module("app").directive("statusLineDirective",["$rootScope","globals","$http","Upload","$interval",function(n,e,t,o,a){return{restrict:"AE",link:function(n,e,t){n.editStatusLine=function(){Promise.resolve().then(function(){return n.main.busy(),Promise.delay(3e3)}).then(function(){n.main.mainCollapse.statusLine=!1}).then(function(){n.main.done()})},n.cancelStatusLine=function(){Promise.resolve().then(function(){return n.main.busy(),Promise.delay(1e3)}).then(function(){n.main.statusLine=""}).then(function(){n.main.mainCollapse.statusLine=!0}).then(function(){n.main.done()})}}}}]),angular.module("app").directive("usernameDirective",["$rootScope","globals","$http",function(n,e,t){return{restrict:"AE",link:function(n,e,t){n.editUsername=function(){Promise.resolve().then(function(){return n.main.busy(),Promise.delay(3e3)}).then(function(){n.main.mainCollapse.username=!1}).then(function(){n.main.done()})},n.cancelUsername=function(){Promise.resolve().then(function(){return n.main.busy(),Promise.delay(1e3)}).then(function(){n.main.username=""}).then(function(){n.main.mainCollapse.username=!0}).then(function(){n.main.done()})}}}}]),angular.module("app").directive("profilePictureUploader",["$rootScope","globals","$http","Upload","$interval",function(n,e,t,o,a){return{restrict:"AE",link:function(t,i,r){function s(){t.uploading.percent<100&&t.uploading.percent++}function c(e,o){u(e,o).progress(function(n){t.uploading.percent=parseInt(80*n.loaded/n.total)}).success(function(e,o,a,i){n.main.responseStatusHandler(e),t.hideProgressBars(),n.main.reloadPage()}).error(function(e){n.main.responseStatusHandler(e),t.hideProgressBars()})}function u(n,t){return o.upload({url:e.getLocationHost()+"/api/uploadProfilePicture",fields:n,file:t})}t.selectedFileType={type:"image"},t.isUploading=!1,t.uploading={show:!1,percent:0,status:"Uploading..."};var l;t.$watch(function(){return t.uploading.percent},function(n,e){80==n&&(t.uploading.status="Processing...",l=a(s,1e3))}),t.showUploading=function(){t.isUploading=!0,t.uploading.percent=0,t.uploading.status="Uploading",t.uploading.show=!0},t.hideProgressBars=function(){t.isUploading=!1,t.uploading.show=!1,t.uploading.status="Uploading",l&&a.cancel(l)},t.upload=function(n){if(n&&n.length){var e=n[0],o={};t.showUploading(),"image"===t.selectedFileType.type&&c(o,e)}}}}}]);
//# sourceMappingURL=app.min.js.map