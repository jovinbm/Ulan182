function trackDigests(e){e.run(["$rootScope",function(e){Promise.setScheduler(function(n){e.$evalAsync(n)})}])}var app=angular.module("app",["ngSanitize","ui.bootstrap","angularUtils.directives.dirDisqus","toastr","ngDialog","ngTable","LocalStorageModule"]).config(["$locationProvider",function(e){e.html5Mode({enabled:!0})}]);trackDigests(app),angular.module("app").directive("createAccountScope",["$rootScope","$http",function(e,n){return{restrict:"AE",link:function(o){function t(t){return n.post("/createAccount",t).then(function(n){return n=n.data,e.main.responseStatusHandler(n),!0})["catch"](function(n){return n=n.data,e.main.responseStatusHandler(n),o.registrationDetails.password1="",o.registrationDetails.password2="",!0})}o.createMain={isBusy:!1},o.registrationDetails={email:"",firstName:"",lastName:"",username:"",password1:"",password2:""},o.createAccount=function(e){return o.createMain.isBusy=!0,t(o.registrationDetails,e).then(function(){o.createMain.isBusy=!1})}}}}]),angular.module("app").directive("resetPasswordScope",["$rootScope","$http",function(e,n){return{restrict:"AE",link:function(o){o.resetMain={isBusy:!1},o.resetFormModel={email:"",newPassword:"",confirmNewPassword:""},o.submitResetPasswordEmail=function(){return o.resetMain.isBusy=!0,n.post("/api/resetPassword/email",o.resetFormModel).then(function(n){n=n.data,e.main.responseStatusHandler(n)})["catch"](function(n){n=n.data,e.main.responseStatusHandler(n),o.resetFormModel.email="",o.resetFormModel.newPassword="",o.resetFormModel.confirmNewPassword="",o.resetMain.isBusy=!1})}}}}]),angular.module("app").directive("signInScope",["$rootScope","$http",function(e,n){return{restrict:"AE",link:function(o){function t(t,r){return Promise.resolve().then(function(){return r?n.post("/localUserLogin?lastpage="+document.referrer,t):n.post("/localUserLogin",t)}).then(function(n){return n=n.data,e.main.responseStatusHandler(n),!0})["catch"](function(n){return n=n.data,o.loginFormModel.password="",e.main.responseStatusHandler(n),!0})}o.signInMain={isBusy:!1},o.loginFormModel={username:"",password:""},o.submitLocalLoginForm=function(e){return o.signInMain.isBusy=!0,t(o.loginFormModel,e).then(function(){o.signInMain.isBusy=!1})}}}}]),angular.module("app").directive("imageAdDirective",["$rootScope","$http",function(e,n){return{restrict:"AE",link:function(o,t,r){function a(){Promise.resolve().then(function(){return n.post("/ad/imageAdHtml",{size:i})["catch"](function(n){throw n=n.data,e.main.responseStatusHandler(n),n}).then(function(n){return n=n.data,e.main.responseStatusHandler(n),n})}).then(function(e){t.empty(),t.append(e)})["catch"](function(e){console.log(e)})}var i=r.adsize.toString(),c=s.words(r.display),u=$(window).width();u>=1200&&c.indexOf("lg")>-1?a():u>=992&&1200>u&&c.indexOf("md")>-1?a():u>=768&&992>u&&c.indexOf("sm")>-1?a():768>u&&c.indexOf("xs")>-1&&a()}}}]),angular.module("app").config(["localStorageServiceProvider",function(e){e.setPrefix("app").setStorageCookieDomain(-1!==document.location.hostname.search("africanexponent")?"africanexponent.com":"").setStorageType("localStorage")}]),angular.module("app").controller("UniversalController",["$filter","$window","$location","$scope","$rootScope","ngDialog","$anchorScroll","$sce","localStorageService","$http",function(e,n,o,t,r,a,i,s,c,u){function l(){return-1!==document.location.hostname.search("africanexponent")?"//www.africanexponent.com":-1!==document.location.hostname.search("amazonaws")?"//ec2-54-85-41-117.compute-1.amazonaws.com:3000":o.port()?"http://localhost:"+o.port():"http://localhost"}r.main={userLocationData:null,getUserLocationData:function(){Promise.resolve().then(function(){return new Promise(function(e,n){function o(){function o(n){var o={country:n.address.country};r.main.saveKeyToCookie("userLocation",o,1),e(!0)}function t(e){var o={country:null};r.main.saveKeyToCookie("userLocation",o,1),n(e)}geolocator.locateByIP(o,t,2)}if(r.main.checkCookieIsEnabled()){var t;(t=r.main.getKeyFromCookie("userLocation",604800))&&t.hasOwnProperty("country")&&t.country?e(!0):o()}else{console.log("Cookie not supported");var a={country:null};r.main.saveKeyToCookie("userLocation",a,7),e(!0)}})})["catch"](function(e){if(!e.msg)throw e;console.log(e.msg)})["catch"](function(e){console.log(e)})},checkLocalStorageSupport:function(){return c.isSupported?!0:!1},checkCookieIsEnabled:function(){return c.cookie.isSupported?!0:!1},saveToLocalStorage:function(e,n){var o={value:n,timestamp:(new Date).getTime()};return c.set(e,o)},getFromLocalStorage:function(e,n){if(n||(n=86400),r.main.checkIfExistsOnLocalStorage(e)){var o=c.get(e),t=o.timestamp,a=(new Date).getTime().toString();return a-t>1e3*n?(r.main.removeFromLocalStorage([e]),!1):o.value}return!1},saveKeyToCookie:function(e,n,o){o||(o=2);var t={value:n,timestamp:(new Date).getTime()};return t=JSON.stringify(t),c.cookie.set(e,t,o)},getKeyFromCookie:function(e,n){n||(n=86400);var o=c.cookie.get(e);if(o){var t=o.timestamp,a=(new Date).getTime().toString();return a-t>1e3*n?(r.main.removeKeyFromCookie(e),!1):o.value}return!1},checkIfExistsOnLocalStorage:function(e){for(var n=c.keys(),o=n.length,t=!1,r=0;o>r;r++)if(n[r]==e){t=!0;break}return t},removeFromLocalStorage:function(e,n){return n?c.clearAll():(e.forEach(function(e){c.remove(e)}),!0)},removeKeyFromCookie:function(e){return c.cookie.remove(e)},windowWidth:$(window).width(),bootStrapWidth:function(e){return e=parseInt(e),e>=1200?"lg":e>=992&&1200>e?"md":e>=768&&992>e?"sm":768>e?"xs":void 0},trustAsHtml:function(e){return s.trustAsHtml(e)},intersectionArray:function(e,n){return _.intersection(e,n)},getAmazonS3Url:function(e){var n="https://assets.africanexponent.com/";return n+e},defaultProfilePicture:"/public/imgsmin/default_avatar/default_avatar_red_462_462.png",isAdmin:function(e){var n=[77,100,101];return 0===e.adminLevels.length?!1:_.intersection(e.adminLevels,n).length>0},assetsDomainWithSlash:function(){return"https://assets.africanexponent.com/"},goToTop:function(){o.hash("pageTop"),i()},back:function(){r.back()},responseStatusHandler:function(n){e("responseFilter")(n)},showToast:function(e,n){r.showToast(e,n)},clearBanners:function(){r.$broadcast("clearBanners")},redirectToAbout:function(){n.location.href="/about"},redirectToLogin:function(){n.location.href="/notLoggedIn"},reloadPage:function(){n.location.reload()},redirectToHome:function(){n.location.href="/"},redirectToPage:function(e){n.location.href=l()+e},redirectToPreviousPage:function(){window.location.href=document.referrer},showExecuting:function(e){var n;return n=e&&"string"==typeof e&&0!==e.length?e+"...":"Performing action...",a.open({data:{message:n},templateUrl:"views/dialogs/executing.html",className:"ngdialog-theme-default",overlay:!0,showClose:!1,closeByEscape:!1,closeByDocument:!1,cache:!0,trapFocus:!1,preserveFocus:!0})}},r.main.getUserLocationData(),r.back=function(){window.history.back()}}]),angular.module("app").directive("resendEmailScope",["$rootScope","$http",function(e,n){return{restrict:"AE",link:function(o){function t(e){return n.post("/resendConfirmationEmail",{userUniqueCuid:e})}o.resendConfirmationEmail=function(n){var o=e.main.showExecuting("Sending Email");t(n).success(function(n){o.close(),e.main.responseStatusHandler(n)}).error(function(n){o.close(),e.main.responseStatusHandler(n)})}}}}]),angular.module("app").filter("responseFilter",["$q","$log","$window","$rootScope","ngDialog",function(e,n,o,t,r){return function(e){function a(e,n,o){return{show:e?!0:!1,bannerClass:n,msg:o}}function i(){r.open({template:"/dialog/not-authorized.html",className:"ngdialog-theme-default",overlay:!0,showClose:!1,closeByEscape:!0,closeByDocument:!0,cache:!1,trapFocus:!0,preserveFocus:!0})}function s(e){r.openConfirm({data:{message:e},template:"/dialog/sign-in.html",className:"ngdialog-theme-default",overlay:!0,showClose:!1,closeByEscape:!1,closeByDocument:!1,cache:!0,trapFocus:!0,preserveFocus:!0}).then(function(){t.main.redirectToPage("/notLoggedIn")},function(){t.main.redirectToPage("/about")})}if(null!==e&&"object"==typeof e){if(e.redirect&&e.redirectPage&&(o.location.href=e.redirectPage),e.reload&&t.main.reloadPage(),e.notify&&e.type&&e.msg&&t.showToast(e.type,e.msg),e.dialog&&e.id)switch(e.id){case"not-authorized":i();break;case"sign-in":s(e.msg)}e.banner&&e.bannerClass&&e.msg&&t.$broadcast("universalBanner",a(!0,e.bannerClass,e.msg)),e.signInBanner&&e.bannerClass&&e.msg&&t.$broadcast("signInBanner",a(!0,e.bannerClass,e.msg)),e.registrationBanner&&e.bannerClass&&e.msg&&t.$broadcast("registrationBanner",a(!0,e.bannerClass,e.msg)),e.reason&&n.warn(e.reason)}return!0}}]),angular.module("app").factory("globals",["$location","$http",function(e,n){var o={};return{userData:function(e){return e?o=e:o},userDataFromServer:function(){return n.get("/api/getUserData")},getLocationHost:function(){return-1!==document.location.hostname.search("africanexponent")?"//www.africanexponent.com":-1!==document.location.hostname.search("amazonaws")?"//ec2-54-85-41-117.compute-1.amazonaws.com:3000":e.port()?"http://localhost:"+e.port():"http://localhost"}}}]),angular.module("app").directive("toastrDirective",["$rootScope","toastr",function(e,n){return{restrict:"AE",link:function(){e.showToast=function(e,o){switch(e){case"success":n.clear(),n.success(o);break;case"warning":n.clear(),n.warning(o,"Warning",{closeButton:!0,tapToDismiss:!0});break;case"error":n.clear(),n.error(o,"Error",{closeButton:!0,tapToDismiss:!0,timeOut:!1});break;default:n.clear()}},e.clearToasts=function(){n.clear()}}}}]).directive("signInBannerScope",["$rootScope",function(e){return{restrict:"AE",link:function(n){n.signInBanner={show:!1,bannerClass:"",msg:""},e.$on("signInBanner",function(e,o){n.signInBanner=o}),e.$on("clearBanners",function(){n.signInBanner={show:!1,bannerClass:"",msg:""}})}}}]).directive("registrationBannerScope",["$rootScope",function(e){return{restrict:"AE",link:function(n){n.registrationBanner={show:!1,bannerClass:"",msg:""},e.$on("registrationBanner",function(e,o){n.registrationBanner=o}),e.$on("clearBanners",function(){n.registrationBanner={show:!1,bannerClass:"",msg:""}})}}}]),angular.module("app").directive("universalBannerScope",["$rootScope","globals",function(e){return{restrict:"AE",link:function(n){n.universalBanner={show:!1,bannerClass:"",msg:""},e.$on("universalBanner",function(e,o){n.universalBanner=o}),e.$on("clearBanners",function(){n.universalBanner={show:!1,bannerClass:"",msg:""}})}}}]),angular.module("app").directive("postTopicScope",["$rootScope","$http",function(e,n){return{restrict:"AE",link:function(o){function t(n){o.mainTopicModel={topic:o.theModel.topic,requestedPage:n},o.mainTopicModel.topic&&o.mainTopicModel.requestedPage&&(o.buttonLoading(),r(o.mainTopicModel).success(function(n){e.main.responseStatusHandler(n),o.theModel.pageNumber++,angular.element("#appendNextPosts").replaceWith(n),o.finishedLoading()}).error(function(n){e.main.responseStatusHandler(n),o.finishedLoading()}))}function r(e){var o=e.topic,t=e.requestedPage;return n.get("/partial/topic/"+o+"?page="+parseInt(t))}o.theModel=JSON.parse(o.model),o.showMore=function(){t(parseInt(o.theModel.pageNumber)+1)},o.buttonLoading=function(){$("#showMoreBtn").button("loading")},o.finishedLoading=function(){$("#showMoreBtn").button("reset")}}}}]);
//# sourceMappingURL=app.min.js.map